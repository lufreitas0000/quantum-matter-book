\section{Fredholm Operators and the Analytical Index}
\label{sec:fredholm_index}

In the previous section, we discovered an integer invariant, the winding number, which arose from the global, topological properties of a map.
We now shift our perspective from topology to analysis.
We will consider a seemingly different kind of problem: solving linear equations in infinite-dimensional spaces.
This is the natural setting for quantum mechanics, where the state of a system is a vector in a Hilbert space and observables are operators.
Here, we will find another robust integer invariant, the analytical index, whose stability is the analytical counterpart to the stability of the winding number.

In physics, we are often interested in the solutions to an operator equation, particularly the zero-energy solutions of a Hamiltonian or Dirac operator, $D\psi = 0$.
The set of all solutions to this equation forms a vector space called the \textbf{kernel} of the operator, denoted $\text{ker}(D)$.
The dimension of the kernel, $\dim(\text{ker}(D))$, counts the number of zero-energy states.

For any linear operator $D: H_1 \to H_2$, we can also define its \textbf{image} (or range), denoted $\text{im}(D)$, which is the subspace of $H_2$ consisting of all vectors that can be written as $D\psi$ for some $\psi \in H_1$.
The rank-nullity theorem states that for a linear operator between finite-dimensional vector spaces, the dimensions of the domain, kernel, and image are related by $\dim(\text{ker}(D)) + \dim(\text{im}(D)) = \dim(H_1)$.
The \textbf{cokernel} of $D$ is defined as the quotient space $\text{coker}(D) = H_2 / \text{im}(D)$.
Its dimension measures the number of independent constraints on the output space; that is, it counts the number of linearly independent vectors in the target space $H_2$ that are not in the image of $D$.
For finite-dimensional spaces, $\dim(\text{coker}(D)) = \dim(H_2) - \dim(\text{im}(D))$.
Combining these gives the familiar result that $\dim(\text{ker}(D)) - \dim(\text{coker}(D)) = \dim(H_1) - \dim(H_2)$.
If the spaces have the same dimension, the index is always zero.

In infinite dimensions, however, these dimensional relations are no longer guaranteed to hold.
The crucial simplification comes when we restrict our attention to a special class of operators known as \textbf{Fredholm operators}.
A Fredholm operator $D: H_1 \to H_2$ between two Hilbert spaces is one that is "almost" invertible.
Specifically, it is an operator for which both the kernel and the cokernel are finite-dimensional.
For our purposes, a more practical definition of the cokernel is its identification with the kernel of the adjoint operator, $D^\dagger$.
That is, $\text{coker}(D) \cong \text{ker}(D^\dagger)$.
So, a Fredholm operator is one for which the number of solutions to both $D\psi=0$ and $D^\dagger\phi=0$ is finite.

For such an operator, we can define a new integer quantity, the \textbf{analytical index} (or Fredholm index).
It is defined as the difference between the dimensions of the kernel and the cokernel:
\begin{equation}
    \text{Index}(D) = \dim(\text{ker}(D)) - \dim(\text{coker}(D)) = \dim(\text{ker}(D)) - \dim(\text{ker}(D^\dagger))
    \label{eq:analytical_index}
\end{equation}
Just like the winding number, the analytical index is a robust integer.
If we continuously perturb the operator $D$, the dimensions of the kernel and cokernel might change.
Individual zero-energy modes may appear or disappear.
However, they always do so in pairs, one for $D$ and one for $D^\dagger$.
As an eigenvalue of $D$ crosses zero, a corresponding eigenvalue for $D^\dagger$ also crosses zero.
This means that while $\dim(\text{ker}(D))$ and $\dim(\text{ker}(D^\dagger))$ can jump, their difference, the index, remains constant.
The analytical index is stable against any small, continuous deformation of the operator.

We have now found two stable integers that characterize a system: one topological (the winding number of a map associated with the system's parameters) and one analytical (the index of an operator associated with the system's dynamics).
The remarkable fact, which we will establish in the next section, is that these two integers are not independent.
They are, in fact, one and the same.

\subsection*{Exercises}

\begin{exercise}
    Consider the operator $D = -i \frac{d}{d\theta}$ acting on functions on the circle $S^1$.
    Instead of periodic functions, consider functions that are sections of a line bundle with a U(1) connection.
    These functions satisfy the twisted boundary condition $\psi(2\pi) = e^{i\alpha}\psi(0)$, where $\alpha \in [0, 2\pi)$ is a parameter corresponding to the holonomy (or Aharonov-Bohm flux) of the connection.
    Compute the index of $D$ and show how the dimension of the kernel depends on the holonomy $\alpha$.
\end{exercise}

\begin{solution}
    The Hilbert space of functions satisfying the twisted boundary condition has an orthonormal basis given by $\psi_n(\theta) = \frac{1}{\sqrt{2\pi}}e^{i(n+\alpha/2\pi)\theta}$ for $n \in \mathbb{Z}$.
    We apply the operator $D = -i\frac{d}{d\theta}$ to these basis functions to find its eigenvalues:
    \begin{equation*}
        D\psi_n = -i \frac{d}{d\theta} \left( \frac{1}{\sqrt{2\pi}}e^{i(n+\alpha/2\pi)\theta} \right) = \left(n+\frac{\alpha}{2\pi}\right) \psi_n
    \end{equation*}
    The eigenvalues are $\lambda_n = n+\alpha/2\pi$.
    The kernel of $D$ is the space of functions with zero eigenvalues. We must solve $\lambda_n = 0$ for an integer $n$.
    This equation has a solution if and only if $\alpha/2\pi$ is an integer.
    Since we defined $\alpha \in [0, 2\pi)$, the only possibility is $\alpha=0$.
    
    Case 1: Trivial holonomy ($\alpha=0$).
    The equation becomes $n=0$. There is one solution. The kernel is spanned by the constant function $\psi_0(\theta) = 1/\sqrt{2\pi}$. Thus, $\dim(\text{ker}(D)) = 1$.
    
    Case 2: Non-trivial holonomy ($\alpha \in (0, 2\pi)$).
    The term $\alpha/2\pi$ is in the interval $(0, 1)$, so $n+\alpha/2\pi$ can never be zero for any integer $n$. There are no zero-energy states, so $\dim(\text{ker}(D)) = 0$.
    
    The operator $D$ is self-adjoint on this space for any $\alpha$, so $D^\dagger = D$.
    This means $\dim(\text{ker}(D^\dagger)) = \dim(\text{ker}(D))$.
    The index is therefore:
    \begin{equation*}
        \text{Index}(D) = \dim(\text{ker}(D)) - \dim(\text{ker}(D^\dagger)) = \begin{cases} 1 - 1 = 0 & \text{if } \alpha=0 \\ 0 - 0 = 0 & \text{if } \alpha \neq 0 \end{cases}
    \end{equation*}
    The index is always 0, demonstrating its stability. The dimension of the kernel jumps as the holonomy changes, but the index remains invariant.
\end{solution}

% \begin{exercise}
%     Consider the twisted Laplacian operator $\Delta_\alpha = -\left(\frac{d}{d\theta} - i\frac{\alpha}{2\pi}\right)^2$ acting on the same space of functions with holonomy $\alpha$.
%     Show that this is a Fredholm operator and compute its index.
% \end{exercise}

% \begin{solution}
%     We can write the operator in terms of the covariant derivative $D_A = -i\left(\frac{d}{d\theta} - i\frac{\alpha}{2\pi}\right)$.
%     Then $\Delta_\alpha = (i D_A)^2 = -D_A^2$.
%     Let's find the eigenvalues of $D_A$ by applying it to the basis functions $\psi_n(\theta) = \frac{1}{\sqrt{2\pi}}e^{i(n+\alpha/2\pi)\theta}$:
%     \begin{equation*}
%         D_A \psi_n = -i\left( i\left(n+\frac{\alpha}{2\pi}\right) - i\frac{\alpha}{2\pi} \right)\psi_n = \left( n+\frac{\alpha}{2\pi} - \frac{\alpha}{2\pi} \right)\psi_n = n\psi_n
%     \end{equation*}
%     The eigenvalues of the covariant derivative $D_A$ are the integers $n \in \mathbb{Z}$.
%     The eigenvalues of our operator $\Delta_\alpha = D_A^2$ are therefore $n^2$.
%     The kernel corresponds to the zero eigenvalue, which occurs only for $n=0$.
%     The corresponding eigenfunction is $\psi_0(\theta) = \frac{1}{\sqrt{2\pi}}e^{i(\alpha/2\pi)\theta}$.
%     This is a single, well-defined function for any value of the holonomy $\alpha$.
%     Thus, the kernel is always one-dimensional: $\dim(\text{ker}(\Delta_\alpha)) = 1$.
    
%     The operator $\Delta_\alpha$ is self-adjoint. This can be shown by noting that the covariant derivative $D_A$ is self-adjoint on this space, so $\Delta_\alpha^\dagger = (D_A^2)^\dagger = (D_A^\dagger)^2 = D_A^2 = \Delta_\alpha$.
%     Therefore, the kernel of the adjoint is the same as the kernel of the original operator: $\dim(\text{ker}(\Delta_\alpha^\dagger)) = 1$.
%     Since both the kernel and cokernel are finite-dimensional (both are 1D), the twisted Laplacian is a Fredholm operator.

%     Its analytical index is constant for all $\alpha$:
%     \begin{equation*}
%         \text{Index}(\Delta_\alpha) = \dim(\text{ker}(\Delta_\alpha)) - \dim(\text{ker}(\Delta_\alpha^\dagger)) = 1 - 1 = 0
%     \end{equation*}
% \end{solution}


\begin{exercise}[The Toeplitz Index]
    Consider the Hilbert space $L^2(S^1)$ of square-integrable functions on the unit circle, with Fourier basis $\{e^{in\theta}\}_{n\in\mathbb{Z}}$. We can split this space into the Hardy space $H^2$, spanned by basis functions with non-negative frequencies ($n \ge 0$), and its complement. Let $P$ be the orthogonal projection operator from $L^2(S^1)$ onto $H^2$.
    For a continuous function $\phi$ on the circle, the \textbf{Toeplitz operator} $T_\phi: H^2 \to H^2$ is defined by first multiplying by $\phi$ and then projecting back to $H^2$: $T_\phi(f) = P(\phi \cdot f)$.
    
    If $\phi(z)$ is never zero, $T_\phi$ is a Fredholm operator whose index is given by $\text{Index}(T_\phi) = -\text{wind}(\phi, 0)$.
    Verify this formula for the functions $\phi(z) = z$ and $\phi(z) = z^{-1}$, where $z=e^{i\theta}$.
\end{exercise}

\begin{solution}
    Let's analyze the action of $T_\phi$ on the basis elements $e^{in\theta}$ of the Hardy space, where $n \ge 0$.

    \textbf{Case 1: $\phi(z) = z = e^{i\theta}$}. The winding number is $\text{wind}(z,0)=1$. The theorem predicts an index of $-1$.
    The operator acts as $T_z(e^{in\theta}) = P(e^{i\theta} \cdot e^{in\theta}) = P(e^{i(n+1)\theta})$. Since $n \ge 0$, $n+1 \ge 1$, so the result is already in the Hardy space and the projection does nothing. $T_z$ simply maps the basis element $e^{in\theta}$ to $e^{i(n+1)\theta}$.
    \begin{itemize}
        \item \textbf{Kernel:} Is there a non-zero function $f = \sum_{n=0}^\infty c_n e^{in\theta}$ such that $T_z f = 0$? Applying the operator gives $\sum_{n=0}^\infty c_n e^{i(n+1)\theta} = 0$. Since the basis elements are orthogonal, this requires all $c_n=0$. The kernel is trivial, so $\dim(\ker T_z) = 0$.
        \item \textbf{Cokernel:} The image of $T_z$ is the space spanned by $\{e^{im\theta}\}_{m \ge 1}$. We can see that the constant function, $e^{i0\theta}=1$, is not in the image. The cokernel is the space of functions in $H^2$ orthogonal to the image, which is precisely the space spanned by the constant function. Thus, $\dim(\text{coker} T_z) = 1$.
    \end{itemize}
    The index is $\text{Index}(T_z) = 0 - 1 = -1$. This matches the formula.

    \textbf{Case 2: $\phi(z) = z^{-1} = e^{-i\theta}$}. The winding number is $\text{wind}(z^{-1},0)=-1$. The theorem predicts an index of $-(-1) = 1$.
    The operator acts as $T_{z^{-1}}(e^{in\theta}) = P(e^{-i\theta} \cdot e^{in\theta}) = P(e^{i(n-1)\theta})$.
    \begin{itemize}
        \item \textbf{Kernel:} We are looking for a function whose image is zero. $T_{z^{-1}}(e^{in\theta}) = 0$ if the result has only negative frequencies. This happens when $n-1 < 0$. Since $n \ge 0$, the only solution is $n=0$. The constant function $f(\theta)=c_0$ is mapped to $P(c_0 e^{-i\theta}) = 0$. The kernel is the space of constant functions, so $\dim(\ker T_{z^{-1}}) = 1$.
        \item \textbf{Cokernel:} For any basis element $e^{im\theta}$ in $H^2$ with $m \ge 0$, we can find a pre-image: $T_{z^{-1}}(e^{i(m+1)\theta}) = P(e^{im\theta}) = e^{im\theta}$. The operator is surjective, so its image is all of $H^2$. The cokernel is trivial, $\dim(\text{coker} T_{z^{-1}}) = 0$.
    \end{itemize}
    The index is $\text{Index}(T_{z^{-1}}) = 1 - 0 = 1$. This again matches the formula.
 \end{solution}

% \begin{exercise}[The Index on the Torus]
%     The Integer Quantum Hall Effect can be modeled by considering electrons on a two-dimensional torus $T^2$ subject to a uniform magnetic field. The topology of this system is described by a complex line bundle $L$ over the torus, whose global "twist" is measured by an integer, the first Chern number $c_1(L) \in \mathbb{Z}$. The dynamics are governed by a Dirac-type operator, the twisted Cauchy-Riemann operator $\bar{\partial}_A$, where $A$ is the connection associated with the magnetic field. The Atiyah-Singer Index Theorem states that $\text{Index}(\bar{\partial}_A) = c_1(L)$.
    
%     Explain the physical significance of this result. What physical quantity corresponds to the analytical index, and what does this equality imply?
% \end{exercise}

% \begin{solution}
%     This theorem provides a profound link between the quantum mechanics of the electron and the global topology of the background magnetic field.
%     \begin{itemize}
%         \item \textbf{Physical meaning of the operator and its kernel:} The operator $\bar{\partial}_A$ is a Hamiltonian for the system. Its kernel, $\ker(\bar{\partial}_A)$, is the space of zero-energy ground states. The dimension of the kernel, $\dim(\ker \bar{\partial}_A)$, is therefore the ground state degeneracy of an electron on the torus.
%         \item \textbf{Physical meaning of the topology:} The Chern number, $c_1(L)$, is a topological invariant that is proportional to the total quantized magnetic flux piercing the torus.
%         \item \textbf{Physical meaning of the theorem:} For this specific operator, it can be shown that its cokernel is trivial, meaning $\dim(\text{coker} \bar{\partial}_A) = 0$. The index theorem therefore simplifies to $\dim(\ker \bar{\partial}_A) = c_1(L)$.
%     \end{itemize}
%     The physical implication is extraordinary: the number of available quantum ground states for the electron (an analytical property found by solving a PDE) is exactly equal to the total number of magnetic flux quanta piercing the surface (a global topological property). This means that if you change the magnetic flux by one fundamental unit, you must create or destroy exactly one ground state. The ground state degeneracy is topologically protected. This is the mathematical foundation of the extreme stability and precise quantization observed in the Integer Quantum Hall Effect.
% \end{solution}
